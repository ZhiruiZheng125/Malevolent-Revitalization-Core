<?xml version="1.0" encoding="utf-8" ?>
<Defs>
<!--Remote resurrector-->
  
  <ThingDef ParentName="MechanitorImplantCraftableBase" MayRequire="ludeon.rimworld.biotech">
    <defName>ApocritonMechResurrector</defName>
    <label>Malevolent Revitalization Core</label>
    <description>The Malevolent Core Revitalizer is a Malevolent-tech implant designed to replicate the resurrection ability of the Apocriton. It grants the user the power to revive nearby mechanoids with incredible efficiency on the battlefield. While the implant is engineered to isolate the psychic interference of the Apocriton, it still establishes a direct connection to the brain, causing the user to faintly hear the "Nefarious Drone" gradually influencing their mind with Malevolent Intelligence. This device also works in synergy with nanofluid data streams to rapidly reset the mechanoid resurrection charges on the frontlines, making it even more capable than the Apocriton in prolonged extermination campaigns. \n\nThe Implant can max upgrade Three times and fully recharged after implant.</description>
    <descriptionHyperlinks>
      <AbilityDef>ApocritonMechResurrector</AbilityDef>
      <ThingDef>nanoCyberSerum</ThingDef>
      <HediffDef>ApocritonMechResurrector</HediffDef>
    </descriptionHyperlinks>
    
    <costList>
      <NanostructuringChip>1</NanostructuringChip>
      <ComponentSpacer>5</ComponentSpacer>
    </costList>

    <statBases>
      <MaxInstallCount>3</MaxInstallCount>
      <MarketValue>3200</MarketValue>
      <WorkToMake>50000</WorkToMake>
    </statBases>
    
    <recipeMaker>
      <researchPrerequisite>UltraMechtech</researchPrerequisite>
      <skillRequirements>
        <Crafting>12</Crafting>
      </skillRequirements>
    </recipeMaker>

    <graphicData> <!--try change color -->
		  <texPath>Things/Item/testCase</texPath>
		  <graphicClass>Graphic_Single</graphicClass>
		  <drawSize>0.8</drawSize>
      <color>(154,124,104)</color>
    </graphicData>

    <comps>
      <li Class="CompProperties_Usable">
        <compClass>CompUsableImplant</compClass>
        <useJob>UseItem</useJob>
        <useLabel>Implant {0_label}</useLabel>
        <userMustHaveHediff>MechlinkImplant</userMustHaveHediff>
      </li>
      <li Class="CompProperties_UseEffectInstallImplant">
        <compClass>ZIRI_ApocritonMechResurrector.CompUseEffect_InstallApocritonMechResurrector</compClass>
        <hediffDef>ApocritonMechResurrector</hediffDef>
        <bodyPart>Brain</bodyPart>
        <canUpgrade>true</canUpgrade>
      </li>
    </comps>
    <!-- <confirmationDialogText>Are you sure you want to install the remote resurrector?</confirmationDialogText> -->
  </ThingDef>

  <HediffDef MayRequire="ludeon.rimworld.biotech">
    <defName>ApocritonMechResurrector</defName>
    <hediffClass>Hediff_Level</hediffClass>
    <label>Malevolent Revitalization Core</label>
    <description>After implanting the Malevolent Core Revitalizer, the user will gradually be influenced by the "Malevolent Drone," becoming indifferent to the deaths of friends and loved ones, while deriving slight pleasure from the deaths of despised organic beings. The assimilation of the Malevolent Drone leads to the erosion of the user's thoughts, causing instinctive hostility toward those who cannot emit mechanoid control signals. To endure prolonged extermination campaigns, the implant also actively suppresses emotional fluctuations in the cerebral cortex and shields against nearby psychic interference, preventing mental breakdowns and ensuring the user remains calm and merciless in brutal battles.</description>
    <descriptionShort>A Malevolent-tech implant that allows the user to fully utilize the Apocriton's Mech Resurrection ability but at the cost of enduring the severe Drone of malevolence.</descriptionShort>
    <descriptionHyperlinks>
      <AbilityDef>ApocritonMechResurrector</AbilityDef>
      <ThingDef>nanoCyberSerum</ThingDef>
      <!-- <HediffDef>ApocritonMechResurrector</HediffDef> -->
      <ThingDef>ApocritonMechResurrector</ThingDef>
    </descriptionHyperlinks>

    <defaultLabelColor>(0.6, 0.6, 1.0)</defaultLabelColor>
    <isBad>false</isBad>
    <priceImpact>true</priceImpact>
    <initialSeverity>1</initialSeverity>
    <minSeverity>0</minSeverity>
    <maxSeverity>3</maxSeverity>
    <keepOnBodyPartRestoration>True</keepOnBodyPartRestoration>
    <levelIsQuantity>true</levelIsQuantity>
    <duplicationAllowed>false</duplicationAllowed>
    <comps>
      <li Class="HediffCompProperties_GiveAbility">
        <abilityDefs>
          <li>ApocritonMechResurrector</li>
        </abilityDefs>
      </li>

      <!-- 憎恶毒蜂死亡爆炸效果 -->
      <li Class = "ZIRI_ApocritonMechResurrector.HediffCompProperties_pawnExpload" >
        <wickTicks>0</wickTicks>
        <explosiveRadius>30.9</explosiveRadius>
        <explodeOnKilled>true</explodeOnKilled>
        <explosiveDamageType>MechBandShockwave</explosiveDamageType>
        <soundDef>MechBandShockwave</soundDef>
        <propagationSpeed>0.5</propagationSpeed>
        <chanceNeverExplodeFromDamage>1</chanceNeverExplodeFromDamage>
        <extraInspectStringKey>MechStunPulseWarning</extraInspectStringKey>
			</li>
      
    </comps>

    <stages>
      <li>
        <minSeverity>1</minSeverity>
        <statOffsets>
          <MechResurrectDistance>6.9</MechResurrectDistance>
          <MechResurrectMaxChargePoint>20</MechResurrectMaxChargePoint>
          <MentalBreakThreshold>-0.04</MentalBreakThreshold>
        </statOffsets>
      </li>

      <li>
        <minSeverity>2</minSeverity>
        <statOffsets>
          <MechResurrectDistance>9.9</MechResurrectDistance>
          <MechResurrectMaxChargePoint>30</MechResurrectMaxChargePoint>
          <MentalBreakThreshold>-0.10</MentalBreakThreshold>
        </statOffsets>
      </li>

      <li>
        <minSeverity>3</minSeverity>
        <statOffsets>
          <MechResurrectDistance>19.9</MechResurrectDistance>
          <MechResurrectMaxChargePoint>50</MechResurrectMaxChargePoint>
          <MentalBreakThreshold>-0.16</MentalBreakThreshold>
        </statOffsets>
      </li>
    </stages>
    
  </HediffDef>

  <AbilityDef MayRequire="ludeon.rimworld.biotech">
    <defName>ApocritonMechResurrector</defName>
    <label>Mech Reawakening</label>
    <description>Malevolent Resurrection Pulse allows the user to fully harness the Apocriton's Mech Resurrection ability. It can unleash a powerful energy pulse without requiring line of sight, overloading fallen nearby mechanoids with incredible efficiency, bringing them back to battle with their injuries intact.</description>
    
    <descriptionHyperlinks>
      <!-- <AbilityDef>ApocritonMechResurrector</AbilityDef> -->
      <ThingDef>nanoCyberSerum</ThingDef>
      <HediffDef>ApocritonMechResurrector</HediffDef>
      <ThingDef>ApocritonMechResurrector</ThingDef>
    </descriptionHyperlinks>
    
    <iconPath>UI/Abilities/MechResurrection</iconPath>
    <cooldownTicksRange>120</cooldownTicksRange>
    <casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
    <warmupStartSound>MechResurrect_Warmup</warmupStartSound>
    <canUseAoeToGetTargets>True</canUseAoeToGetTargets>
    <statBases>
        <Ability_EffectRadius>5</Ability_EffectRadius>
    </statBases>
    <warmupEffecter>ApocrionAoeWarmup</warmupEffecter>
    <hostile>false</hostile>
    <displayGizmoWhileUndrafted>true</displayGizmoWhileUndrafted>
    <disableGizmoWhileUndrafted>false</disableGizmoWhileUndrafted>
    <hotKey>Misc12</hotKey>
    <uiOrder>5</uiOrder>
    <verbProperties>
      <verbClass>Verb_CastAbility</verbClass>
      <soundCast>MechResurrect_Cast</soundCast>
      <warmupTime>4</warmupTime>
      <onlyManualCast>true</onlyManualCast>
      <range>6.9</range>
      <rangeStat>MechResurrectDistance</rangeStat>
      <requireLineOfSight>false</requireLineOfSight>
      <targetParams>
        <canTargetPawns>false</canTargetPawns>
        <canTargetBuildings>false</canTargetBuildings>
        <canTargetCorpses>true</canTargetCorpses>
        <canTargetAnimals>false</canTargetAnimals>
        <canTargetHumans>false</canTargetHumans>
        <canTargetMechs>true</canTargetMechs>
      </targetParams>
    </verbProperties>

    <comps>
      <li Class="ZIRI_ApocritonMechResurrector.CompProperties_MechanitorResurrectMech"> <!-- CompProperties_AbominableMechResurrect/CompProperties_MechanitorResurrectMech -->
        <compClass>ZIRI_ApocritonMechResurrector.CompAbilityEffect_MechanitorResurrectMech</compClass>
        <maxCorpseAgeTicks>3600</maxCorpseAgeTicks><!-- max mech been resurrected time 60s -->
        <appliedEffecterDef>MechResurrected</appliedEffecterDef>
        <resolveEffecterDef>MechResurrected</resolveEffecterDef>
        <costs>
          <li>
            <weightClass>Light</weightClass>
            <cost>1</cost>
          </li>
          <li>
            <weightClass>Medium</weightClass>
            <cost>3</cost>
          </li>
          <li>
            <weightClass>Heavy</weightClass>
            <cost>5</cost>
          </li>
        </costs>
      </li>      
    </comps>
  </AbilityDef>

 

</Defs>